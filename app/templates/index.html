{% extends "base.html" %}

{% block title %}Vocaloid Rate{% endblock %}

{% block content %}
  {% set title = "Vocaloid Rate" %}
  {% include "partials/header.html" %}

  <div class="mb-8 rounded-md bg-card-bg p-5 shadow-md">
    <form
      id="filter-form"
      class="flex flex-col items-stretch gap-5 md:flex-row md:flex-wrap md:items-center"
    >
      <div class="flex items-center gap-2 rounded border border-border p-3">
        <label class="font-bold">Status:</label>
        <input
          type="radio"
          id="rank_ranked"
          name="rank_filter"
          value="ranked"
          {%
            if filters.rank_filter=='ranked'
            or not filters.rank_filter
          %}
            checked
          {% endif %}
        />
        <label for="rank_ranked">On Chart</label>

        <input
          type="radio"
          id="rank_unranked"
          name="rank_filter"
          value="unranked"
          {%
            if
            filters.rank_filter=='unranked'
          %}
            checked
          {% endif %}
        />
        <label for="rank_unranked">Archived</label>

        <input
          type="radio"
          id="rank_all"
          name="rank_filter"
          value="all"
          {% if filters.rank_filter=='all' %}
            checked
          {% endif %}
        />
        <label for="rank_all">All</label>
      </div>

      <div class="relative w-full md:flex md:w-50 md:items-center md:gap-2">
        <label
          for="rated_filter"
          class="mb-1 block font-bold md:mb-0 md:text-right"
          >Rating:</label
        >
        <select
          name="rated_filter"
          id="rated_filter"
          class="w-full rounded border border-border bg-background px-3 py-2 pr-10 leading-normal text-foreground shadow-md"
        >
          <option
            value="all"
            {% if filters.rated_filter=='all' %}selected{% endif %}
          >
            All
          </option>
          <option
            value="rated"
            {% if filters.rated_filter=='rated' %}selected{% endif %}
          >
            Rated
          </option>
          <option
            value="unrated"
            {% if filters.rated_filter=='unrated' %}selected{% endif %}
          >
            Unrated
          </option>
        </select>
      </div>

      <div class="relative w-full md:w-52">
        <input
          type="text"
          name="title_filter"
          id="title_filter"
          autocomplete="off"
          placeholder="Search by title..."
          class="w-full rounded border border-border bg-background px-3 py-2 pr-10 leading-normal text-foreground shadow-md"
          value="{{ filters.title_filter or '' }}"
        />
        <button
          type="button"
          data-clear
          class="invisible absolute top-1/2 right-2 -translate-y-1/2 cursor-pointer px-1 py-0 text-xl leading-none text-foreground opacity-0"
          aria-label="Clear title search"
        >
          &times;
        </button>
      </div>

      <div class="relative w-full md:w-52">
        <input
          type="text"
          name="producer_filter"
          id="producer_filter"
          list="producers-list"
          autocomplete="off"
          placeholder="Filter by producer..."
          value="{{ filters.producer_filter or '' }}"
          class="w-full rounded border border-border bg-background px-3 py-2 pr-10 leading-normal text-foreground shadow-md"
          value="{{ filters.producer_filter or '' }}"
        />
        <button
          type="button"
          data-clear
          class="invisible absolute top-1/2 right-2 -translate-y-1/2 cursor-pointer px-1 py-0 text-xl leading-none text-foreground opacity-0"
          aria-label="Clear producer filter"
        >
          &times;
        </button>
        <datalist id="producers-list">
          {% for producer in all_producers %}
            <option value="{{ producer }}"></option>
          {% endfor %}
        </datalist>
      </div>

      <div class="relative w-full md:flex md:w-52 md:items-center md:gap-2">
        <input
          type="text"
          name="voicebank_filter"
          id="voicebank_filter"
          list="voicebanks-list"
          autocomplete="off"
          placeholder="Filter by voicebank..."
          value="{{ filters.voicebank_filter or '' }}"
          class="w-full rounded border border-border bg-background px-3 py-2 pr-10 leading-normal text-foreground shadow-md"
        />
        <button
          type="button"
          data-clear
          class="invisible absolute top-1/2 right-2 -translate-y-1/2 cursor-pointer px-1 py-0 text-xl leading-none text-foreground opacity-0"
          aria-label="Clear voicebank filter"
        >
          &times;
        </button>
        <datalist id="voicebanks-list">
          {% for voicebank in all_voicebanks %}
            <option value="{{ voicebank }}"></option>
          {% endfor %}
        </datalist>
      </div>

      <div class="relative w-full md:flex md:w-50 md:items-center md:gap-2">
        <label
          for="limit_filter"
          class="mb-1 block font-bold md:mb-0 md:text-right"
          >Per Page:</label
        >
        <select
          name="limit"
          id="limit_filter"
          class="w-full rounded border border-border bg-background px-3 py-2 pr-10 leading-normal text-foreground shadow-md"
        >
          <option
            value="all"
            {% if pagination.limit=='all' %}selected{% endif %}
          >
            All
          </option>
          <option value="25" {% if pagination.limit=='25' %}selected{% endif %}>
            25
          </option>
          <option value="50" {% if pagination.limit=='50' %}selected{% endif %}>
            50
          </option>
          <option
            value="100"
            {% if pagination.limit=='100' %}selected{% endif %}
          >
            100
          </option>
        </select>
      </div>

      <button
        type="button"
        id="clear-filters-btn"
        class="cursor-pointer rounded border border-gray-text p-2 font-bold text-gray-text shadow-md ease-in-out hover:transition-colors hover:duration-200 enabled:hover:bg-gray-hover"
      >
        Clear
      </button>

      <button
        type="button"
        id="scrape-button"
        class="cursor-pointer rounded border border-green-text p-2 font-bold text-green-text shadow-md ease-in-out hover:transition-colors hover:duration-200 enabled:hover:bg-green-hover"
      >
        Update Tracks
      </button>

      <span id="scrape-status"></span>
    </form>
  </div>

  <div
    class="overflow-x-visible rounded border border-none border-border bg-card-bg shadow-md md:overflow-x-auto"
  >
    <table class="w-full border-collapse">
      {% include "partials/tracks_table_head.html" %}
      <tbody
        id="tracks-table-body"
        class="bg-background"
        data-update-url="/_/tracks_table_body"
      >
        {% include "partials/tracks_table_body.html" %}
      </tbody>
    </table>
  </div>

  <div
    class="mt-8 flex-wrap items-center justify-center gap-3"
    id="pagination-container"
  >
    <button
      class="cursor-pointer rounded border border-sky-text p-2 font-bold text-sky-text shadow-md ease-in-out hover:transition-colors hover:duration-200 enabled:hover:bg-sky-hover disabled:cursor-not-allowed disabled:opacity-50"
      id="prev-page-btn"
      disabled
    >
      Previous
    </button>
    <div class="flex items-center gap-2" id="page-links"></div>
    <button
      class="cursor-pointer rounded border border-sky-text p-2 font-bold text-sky-text shadow-md ease-in-out hover:transition-colors hover:duration-200 enabled:hover:bg-sky-hover disabled:cursor-not-allowed disabled:opacity-50"
      id="next-page-btn"
      disabled
    >
      Next
    </button>
  </div>

  <script src="{{ url_for('static', path='js/main.min.js') }}"></script>
{% endblock %}
